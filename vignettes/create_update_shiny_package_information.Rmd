---
title: "Create and update a shiny package"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Create and update a shiny package}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  eval = FALSE,
  collapse = TRUE,
  comment = "#>"
)
```

This documents the functions to run to help create and update a R shiny package. Further information can be found at

* [devtools documentation](https://devtools.r-lib.org/)
* [usethis documentation](https://usethis.r-lib.org/)
* [pkgdown documentation](https://pkgdown.r-lib.org/)
* [renv documentation](https://rstudio.github.io/renv/articles/renv.html)
* [golem documentation](https://thinkr-open.github.io/golem/)

## Set environment 

**usethis::use_blank_slate** turn off saving and restoring workspace between sessions

```{r}
usethis::use_blank_slate(scope = "project")
```

## Create the skeleton package

**golem::create_golem** create the skeleton shiny package directory structure, opening the package in a new R Studio session as a new project.

* R folder containing **app_config.R**, **app_server.R**, **app_ui.R**, **run_app.R**
* inst folder containing **golem-config.yml**
* inst/app/www folder for external files and images

```{r}
golem::create_golem("C:/Files/packages/shinystore")
```

**golem::fill_desc** update the title, author and description details in the description file
```{r}
golem::fill_desc(
  pkg_name = "shinystore", # The Name of the package containing the App
  pkg_title = "Stores a shiny example app using modules", # The Title of the package containing the App
  pkg_description = "This shiny package is an example shiny app created using the 
  golem package and using shiny modules. It demonstrates many of the shiny techniques 
  described in Hadley Wickham's Mastering Shiny book", # The Description of the package containing the App
  author_first_name = "Graham", # Your First Name
  author_last_name = "French", # Your Last Name
  author_email = "gcfrench@googlemail.com", # Your Email
  repo_url = "https://gcfrench.github.io/shinystore" # The URL of the GitHub Repo (optional)
)
```

**golem::set_golem_options()** update golem-config file with description information
and set here path
```{r}
golem::set_golem_options()
```

**usethis::use_cc0_license** add one of the license options for the package
```{r}
usethis::use_cc0_license()
```

**usethis::use_readme_rmd** add a readme file, removing the default text from the file. This file is displayed as the front home page in the pkgdown website
```{r}
usethis::use_readme_rmd()
```

```{}
## Overview

## Installation

## Usage

## Publication
```

**usethis::use_news_md** add a news file, removing the default text from the file. This file will contain the news on each version release
```{r}
usethis::use_news_md()
```

```{}
## package_name 0.0.0.9000 <font size="4">yyyy-mm-dd</font>
```

**usethis::use_pipe** add the %>% pipe operator with the addition of the utils-pipe.R file and magrittr package to the imports field in the description file
```{r}
usethis::use_pipe()
```

**usethis::use_data_raw** add the data-raw directory and empty lookup_raw containing the scripts used to format and add lookup datasets
```{r}
usethis::use_data_raw("lookup_raw")
```

**golem::use_recommended_tests()** add the test folder and golem tests
```{r}
golem::use_recommended_tests()
```

**golem::use_recommended_deps()** add recommended package dependencies
```{r}
golem::use_recommended_deps()
```

**golem::use_utils_ui()** and **golem::use_utils_server()** adds golem utility functions
```{r}
golem::use_utils_ui()
golem::use_utils_server()
```

**devtools::document** add the man directory containing the document .Rd files. Documents can also be updated using Ctlr-shift-D or through the Build:Document menu
```{r}
devtools::document()
```

**usethis::use_vignette** add tasks vignette
```{r}
usethis::use_vignette("tasks")
```

```{}
This **tasks** section contains a list of tasks and questions, with
their current status

-   ✔️ completed
-   ❗ awaiting completion
-   ✖️no longer needed
-   ❓question to be answered

## Tasks and questions

### YYYY-MM-DD
```

**usethis::use_pkgdown** add the _pkgdown.yml file used to create the menu structure for the package website
```{r}
usethis::use_pkgdown()
pkgdown::init_site()
```

**pkgdown::build_article** create tasks html report
```{r}
pkgdown::build_article("tasks")
```

**create yaml template** pkgdown.yml template
```{}
title: TITLE_HERE
template:
  bootstrap: 5
  bootswatch: flatly

navbar:
  left:
    - icon: fa-home fa-lg
      href: index.html
    - text: information
      menu:
      - text:
        href:
    - text: "lookups and functions"
      href: reference/index.html
    - text: "archive"
      menu:
      - text:
        href:
    - text: "tasks"
      href: articles/tasks.html
    - text: "versions"
      href: news/index.html
  right:
    - icon: "fab fa-github fa-lg"
      href: https://github.com/URL_HERE
```

**usethis::use_lifecycle** add the lifecycle badges in the man directory
```{r}
usethis::use_lifecycle()
```

**usethis::use_lifecycle_badge** add lifecycle badge to home page
```{r}
usethis::use_lifecycle_badge("experimental") # "experimental", "stable". "superseded", "deprecated"
```

**usethis::use_logo** add a hex logo to home page
```{r}
# create hex logo using hexmake https://connect.thinkr.fr/hexmake
usethis::use_logo("image_path")
golem::use_favicon( path = "path/to/favicon")
# golem::remove_favicon()
```

**pkgdown::build_site** build documentation
```{r}
pkgdown::build_site()
```

### Add to github --------------------------------------------

**usethis::use_git** initiates a Git repository, making the initial commits
```{r}
usethis::use_git()
```

**usethis::use_github** creates the repository on Github and pushes the initial commits. This needs a Github Personal Access Token (PAT) which can be created using **usethis::create_github_token**. Information on how to do this can be found in [Happy Git and Github for the useR](https://happygitwithr.com/credential-caching.html)
```{r}
usethis::use_github()
# usethis::create_github_token()
```

**usethis::use_github_action** configures files to use github to host package website
```{r}
usethis::use_github_action("pkgdown")
```

### Add package versioning --------------------------------------------

Navigate to the home project directory first

**renv::init** initiates the renv environment, creating the renv folder and adding the renv.lock file, linking the relevant packages from the renv cache
```{r}
renv::init()
```

**renv::status** check the renv lock file is up-to-date, run **renv::snapshot** to update the renv lock file if not

```{r}
renv::status()
renv::snapshot()
```

**renv::deactivate** turn off the renv environment, then manually delete the renv folder and .Rprofile file
```{r}
renv::deactivate()
```

Navigate to the home project directory first

**renv::activate** turn on the renv environment
```{r}
renv::activate()
```

**renv::restore** restore the package versions contained within the renv lock file
```{r}
renv::restore()
```

## Add and edit script files

**golem::add_module()** add module in R folder
```{r}
golem::add_module(name = "MODULE_NAME")
```

**golem::add_js_file()** add javascript and blank css file to inst/app/www folder
```{r}
golem::add_js_file( "script" )
golem::add_js_handler( "handlers" )
golem::add_css_file( "custom" )
```


**golem::add_utils()**

**golem::add_fct()**

**golem::amend_golem_config()**

**golem::set_golem_version("0.0.1")**



