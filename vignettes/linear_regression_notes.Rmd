---
title: "Linear regression notes"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Linear regression notes}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

This example using linear regression to explore the relationship between the body mass and flipper length of palmer penguins, taken from the [palmerpenguins](https://allisonhorst.github.io/palmerpenguins/) package, was created whilst reading

-   Chapter 3 of [An Introduction to Statistical Learning with Applications in R](https://www.statlearning.com/), second edition, by Gareth James, Daniela Witten, Trevor Hastie and Robert Tibshirani

-   [Statistical Inference via Data Science. A ModernDive into R and the Tidyverse](https://moderndive.com/), by Chester Ismay and Albert Kim

```{r echo=FALSE, warning=FALSE, fig.width=4, fig.height=4}
suppressPackageStartupMessages({
  suppressWarnings({
    library(palmerpenguins)
    library(dplyr)
    library(ggplot2)
    library(broom)
    library(knitr)
  })
})

penguins_mass_flipper <- penguins %>%
  select(species, flipper_length_mm, body_mass_g)

penguins_mass_flipper_plot <- ggplot(data = penguins_mass_flipper,
                                     aes(x = flipper_length_mm,
                                         y = body_mass_g)) +
  geom_point() +
  theme_minimal() +
  labs(title = "Penguin size, Palmer Station LTER",
       subtitle = "Flipper length and body mass for 3 species of penguins",
       x = "Flipper length (mm)",
       y = "Body mass (g)") +
  theme(plot.title.position = "plot",
        plot.caption = element_text(hjust = 0, face= "italic"),
        plot.caption.position = "plot")
penguins_mass_flipper_plot
```

Linear regression calculates a least squares line with the smallest sum of squared residuals and is run using the **lm function** in the stats package, with the output presented as a more tidy data frame using the **tidy function** in the broom package.

```{r}
penguins_regression_model <- lm(formula = body_mass_g ~ flipper_length_mm, 
                                data = penguins_mass_flipper) %>% 
  tidy(conf.int = TRUE) 
kable(penguins_regression_model)
```

-   **estimate** gives the intercept (first row) and slope (second row) values for the regression line.

-   **std.error** indicates how close the sample regression line is to the underlying population regression line, with the 95% confidence interval approximately equal to Â± 2 x Standard Error.

-   **conf.low** and **conf.high** more accurate upper and lower values for the 95% confidence interval.

## Assumptions 

-   The relationship between the variables is approximately linear.

-   Different observations must be independent of one another.

-   The residuals should be normally distributed, centred around zero so that there is an equal number of positive and negative errors above and below the slope, with on average the error equalling zero.

-   The residuals should show equal variance across all values of the explanatory variable, so that the value and spread of the residuals don't depend on the value of the explanatory variable on the x axis.




